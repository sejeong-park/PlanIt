<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.trip.planit.plan.model.mapper.PlanMapper">

	<resultMap type="planRegistDto" id="planRegistDto">
		<result column="plan_key" property="planKey"/>
		<result column="anonymous_password" property="anonymousPassword"/>
		<result column="start_date" property="startDate"/>
		<result column="end_date" property="endDate"/>
	</resultMap>

	<insert id="insertPlan" parameterType="planRegistDto">
		insert into trip_plans(plan_key, create_user, anonymous_password, start_date, end_date, create_at)
		values(#{planKey},#{createUser} ,#{anonymousPassword}, "2023-11-08", "2023-11-08", #{createAt}) 
	</insert>
	
	<insert id="insertPlanDetail" parameterType="list">
	insert into trip_details(plan_date, plan_key, sequence, title, content, attraction_id)
			values
		<foreach collection="list" item="planDetailDto" separator=",">
			(
			#{planDetailDto.planDate}, #{planDetailDto.planKey}, #{planDetailDto.sequence}, 
			#{planDetailDto.title}, #{planDetailDto.content}, #{planDetailDto.attractionId}
			)
		</foreach>
	</insert>
	
	<select id="selectAllPlan" resultMap="planRegistDto">
		select plan_key, start_date, end_date, create_at, update_at, title, create_user from trip_plans;
	</select>
</mapper>